## План реализации автотестов

https://habr.com/ru/company/yandex/blog/517266/

Юнит-тестами надо покрыть стейт-машину.
Тестировать класс convmachine:
- создаём объект класса
- скармливаем ей сценарий кастомный с функциями-загушками
- тестируем как оно будет работать

Интеграционные тесты именно для нашего сценария.
https://github.com/LonamiWebs/Telethon
https://github.com/pyrogram/pyrogram


### Юнит-тесты convmachine

! Проблема: тестировать можно только если сработает `register_handlers(self, dispatcher: Dispatcher):`, которому нужно скормить dispatcher, который умеет `dispatcher.add_handler`. Придётся эти штуки прописать.

Кейсы:

- Работа параметра is_state — сохраняются ли данные о стейте
- Работают ли разные callback-и

### Интеграционные тесты

Подразумевает, что надо будет вносить изменения в базу

1. Обнуляем верификацию, стучимся к юзеру и проходим по сценарию верификации. Проставляем верификацию обратно.
2. Тыкаемся в бота и получаем менюху
3. Формируем опрос, проходим по сценарию, получаем опрос в тестовой группе
4. Голосуем в опросе в тестовой группе, видим запись в базе
5. Запрашиваем в менюхе стату и получаем её